<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://foreops.com/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://foreops.com/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://foreops.com/main.d7bc1956fe5638836e64f38383fbd694033946b03a4b64f1d774da0489ad2999b7701a0201bea1bf79a558f3eb28c76188eb7793427ce940b0d87a1f59656f6e.css integrity="sha512-17wZVv5WOINuZPODg/vWlAM5RrA6S2Tx13TaBImtKZm3cBoCAb6hv3mlWPPrKMdhiOt3k0J86UCw2HofWWVvbg==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Admission Control in Kubernetes - foreops_</title><meta name=description content="Admission controllers are essential for security, governance, and configuration management in Kubernetes."><link rel=canonical href=https://foreops.com/blog/kubernetes-admission-control/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/blog/kubernetes-admission-control/kubernetes-admission-control.jpg"><meta name=twitter:title content="Admission Control in Kubernetes"><meta name=twitter:description content="Admission controllers are essential for security, governance, and configuration management in Kubernetes."><meta name=twitter:site content="@foreops_"><meta name=twitter:creator content="@foreops_"><meta property="og:title" content="Admission Control in Kubernetes"><meta property="og:description" content="Admission controllers are essential for security, governance, and configuration management in Kubernetes."><meta property="og:type" content="article"><meta property="og:url" content="/blog/kubernetes-admission-control/"><meta property="og:image" content="/blog/kubernetes-admission-control/kubernetes-admission-control.jpg"><meta property="article:published_time" content="2021-06-28T11:00:16-04:00"><meta property="article:modified_time" content="2021-06-28T11:00:16-04:00"><meta property="og:site_name" content="foreops_"><meta property="article:publisher" content="https://www.facebook.com/foreops_"><meta property="article:author" content="https://www.facebook.com/foreops_"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"\/blog\/kubernetes-admission-control\/"},"headline":"Admission Control in Kubernetes","image":["/blog/kubernetes-admission-control/kubernetes-admission-control.jpg"],"datePublished":"2021-06-28T11:00:16CET","dateModified":"2021-06-28T11:00:16CET","author":{"@type":"Organization","name":"foreops_"},"publisher":{"@type":"Organization","name":"foreops_","logo":{"@type":"ImageObject","url":"\/images\/foreops-logo.png"}},"description":"Admission controllers are essential for security, governance, and configuration management in Kubernetes."}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/foreops.com\/"},{"@type":"ListItem","position":3,"name":"Blog","item":"https:\/\/foreops.com\/\/blog\/"},{"@type":"ListItem","position":4,"name":"Kubernetes Admission Control","item":"https:\/\/foreops.com\/\/blog\/kubernetes-admission-control\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://foreops.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://foreops.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://foreops.com/favicon-16x16.png><link rel=manifest href=https://foreops.com/site.webmanifest></head><body class="blog single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 me-auto" href=https://foreops.com/><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="120" viewBox="0 0 614.52 168.6" style="enable-background:new 0 0 614.52 168.6"><style>.st0{fill:red}.st1{fill:currentColor;stroke:currentColor;stroke-width:2.228;stroke-miterlimit:10}</style><rect x="524.08" y="121.45" class="st0" width="90.43" height="47.15"/><path class="st1" d="M43.24 52.84v10.98h29.78V75.9H43.24v44.18H28.69V75.9H5.78V63.82H28.7V53.53c0-12.62 2.86-22.07 8.58-28.33 5.72-6.27 14.34-9.4 25.86-9.4 5.21.0 10.25.46 15.09 1.37l-1.51 12.62c-5.4-.64-10.06-.96-14-.96C49.73 28.83 43.24 36.84 43.24 52.84z"/><path class="st1" d="M96.18 117.02c-4.78-2.95-8.42-7.25-10.91-12.9s-3.74-12.45-3.74-20.41 1.25-14.76 3.74-20.41c2.49-5.65 6.13-9.95 10.91-12.9 4.78-2.95 10.51-4.43 17.19-4.43 6.68.0 12.41 1.48 17.19 4.43s8.42 7.25 10.91 12.9c2.49 5.65 3.74 12.45 3.74 20.41s-1.25 14.76-3.74 20.41c-2.49 5.65-6.13 9.95-10.91 12.9s-10.51 4.43-17.19 4.43C106.69 121.45 100.96 119.98 96.18 117.02zM125.75 102c2.9-4.28 4.36-10.37 4.36-18.28s-1.45-14.01-4.36-18.28c-2.91-4.28-7.03-6.41-12.38-6.41s-9.48 2.14-12.38 6.41c-2.91 4.28-4.36 10.37-4.36 18.28s1.45 14.01 4.36 18.28c2.9 4.28 7.03 6.42 12.38 6.42C118.72 108.42 122.84 106.28 125.75 102z"/><path class="st1" d="M215.98 48.83c3.13 1.9 5.44 4.84 6.93 8.82s2.23 9.19 2.23 15.64h-14.41c0-5.26-.79-9.07-2.37-11.42-1.58-2.36-4.13-3.53-7.65-3.53-6.08.0-10.67 2.61-13.76 7.82-3.09 5.21-4.63 12.76-4.63 22.64V108h17.84v12.08h-48.57V108h16.19V59.43h-13.45V47.35h25.25l2.47 18.66h1.65c.41-6.72 2.27-11.74 5.59-15.06s8.13-4.97 14.44-4.97C208.76 45.98 212.84 46.93 215.98 48.83z"/><path class="st1" d="M295.39 90.17h-49.12c1.28 6.04 4.16 10.63 8.64 13.79 4.48 3.16 10.38 4.73 17.7 4.73 5.63.0 11.57-.64 17.84-1.92l1.78 12.76c-6.72 1.28-13.81 1.92-21.27 1.92-8.28.0-15.31-1.46-21.1-4.39s-10.19-7.21-13.21-12.86-4.53-12.52-4.53-20.62c0-7.87 1.28-14.61 3.84-20.24 2.56-5.63 6.3-9.92 11.22-12.9 4.92-2.97 10.83-4.46 17.73-4.46 9.88.0 17.5 3 22.85 8.99s8.03 14.61 8.03 25.86C295.81 84.17 295.67 87.28 295.39 90.17zM282.63 79.05c0-6.49-1.54-11.5-4.63-15.02-3.09-3.52-7.4-5.28-12.93-5.28-5.63.0-10.11 1.76-13.45 5.28-3.34 3.52-5.31 8.53-5.9 15.02h36.91z"/><path class="st1" d="M317.88 117.02c-4.78-2.95-8.42-7.25-10.91-12.9s-3.74-12.45-3.74-20.41 1.25-14.76 3.74-20.41c2.49-5.65 6.13-9.95 10.91-12.9 4.78-2.95 10.51-4.43 17.19-4.43s12.41 1.48 17.19 4.43 8.42 7.25 10.91 12.9c2.49 5.65 3.74 12.45 3.74 20.41s-1.25 14.76-3.74 20.41c-2.49 5.65-6.13 9.95-10.91 12.9-4.78 2.95-10.51 4.43-17.19 4.43C328.38 121.45 322.65 119.98 317.88 117.02zM347.44 102c2.9-4.28 4.36-10.37 4.36-18.28s-1.45-14.01-4.36-18.28c-2.9-4.28-7.03-6.41-12.38-6.41s-9.48 2.14-12.38 6.41c-2.9 4.28-4.36 10.37-4.36 18.28s1.45 14.01 4.36 18.28c2.9 4.28 7.03 6.42 12.38 6.42S344.54 106.28 347.44 102z"/><path class="st1" d="M427.38 50.48c4.37 3 7.68 7.38 9.95 13.14 2.26 5.76 3.4 12.69 3.4 20.79.0 7.91-1.13 14.64-3.4 20.17-2.26 5.54-5.56 9.73-9.88 12.59s-9.55 4.29-15.68 4.29c-5.58.0-10.08-1.08-13.52-3.22s-5.38-5.28-5.83-9.4h-1.37v42.81h-14.54V47.35h13.17l1.17 13.17h1.58c.64-4.89 2.55-8.54 5.73-10.94s7.67-3.6 13.48-3.6C417.77 45.98 423.01 47.48 427.38 50.48zm-5.31 52.38c2.83-4.16 4.25-10.31 4.25-18.46.0-8.32-1.45-14.75-4.36-19.28s-7.03-6.79-12.38-6.79c-12.35.0-18.52 6.95-18.52 20.86v17.56c0 8.23 6.13 12.35 18.39 12.35C415.02 109.1 419.23 107.02 422.07 102.86z"/><path class="st1" d="M454.56 120.97c-3.91-.32-7.44-.85-10.6-1.58l1.65-13.17c9.33 1.46 17.06 2.2 23.19 2.2 7.32.0 12.65-.72 15.99-2.16 3.34-1.44 5.01-3.74 5.01-6.9.0-2.1-.56-3.71-1.68-4.8-1.12-1.1-2.94-1.97-5.45-2.61l-16.74-4.25c-4.67-1.19-8.39-2.56-11.18-4.12-2.79-1.55-4.87-3.53-6.24-5.93-1.37-2.4-2.06-5.41-2.06-9.02.0-5.35 1.29-9.68 3.88-13 2.58-3.32 6.61-5.75 12.08-7.31 5.46-1.55 12.59-2.33 21.37-2.33 6.68.0 13.08.46 19.21 1.37l-1.51 12.62c-6.91-.64-12.94-.96-18.11-.96-7.68.0-13.24.7-16.67 2.09-3.43 1.4-5.15 3.67-5.15 6.83.0 2.01.59 3.52 1.78 4.53s3.2 1.88 6.04 2.61l13.45 3.29c5.21 1.28 9.42 2.79 12.62 4.53s5.58 3.91 7.13 6.52 2.33 5.83 2.33 9.67c0 5.26-1.26 9.53-3.77 12.79-2.52 3.27-6.42 5.68-11.7 7.24-5.28 1.55-12.16 2.33-20.62 2.33C463.22 121.45 458.47 121.29 454.56 120.97z"/><rect x="11.19" y="108.13" class="st1" width="50.78" height="12"/></svg></a><button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://twitter.com/foreops_><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><span class="ms-2 visually-hidden">Twitter</span></a></li><li class=nav-item><a class=nav-link href=https://github.com/foreops><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ms-2 visually-hidden">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=https://foreops.com/blog/>Blog</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder=Search... aria-label=Search... autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row justify-content-center"><div class="col-md-12 col-lg-10 col-xl-8"><article><div class=blog-header><h1>Admission Control in Kubernetes</h1><p><small>Posted June 28, 2021 by <a class="stretched-link position-relative" href=https://foreops.com/contributors/sharjeel-aziz/>Sharjeel Aziz</a>&nbsp;&dash;&nbsp;<strong>7&nbsp;min read</strong></small><p><a href=https://foreops.com/tags/authentication/>#authentication</a>
<a href=https://foreops.com/tags/authorization/>#authorization</a>
<a href=https://foreops.com/tags/kubernetes/>#kubernetes</a></div><p class=lead>Admission controllers are essential for security, governance, and configuration management in Kubernetes.</p><p>They come in handy to implement or validate resource limits or ensure that the deployments are not using the &ldquo;latest&rdquo; image tags. For instance, you can restrict pods to pull container images from certain registries or disallow containers to run in privileged mode. In addition, admission controllers can enforce label naming conventions or add annotations, such as a cost center to objects.</p><p>The admission controllers intercept requests made to the API server before the persistence of the object. The API server passes the request to admission controllers after successfully authenticating and authorizing the request. After that, Kubernetes persists everything to <a href=https://etcd.io/>etcd</a> datastore if admission controllers allow it. etcd is a key/value datastore that stores the current configuration, objects, metadata, and the actual and desired state of the cluster. Kubernetes watches the etcd database for updates and makes any changes if the actual and desired states diverge. That is why admission controllers sit between the persistence of the request and only admitted requests are allowed to change the desired state of the cluster.</p><pre><code class=language-go>// DefaultOffAdmissionPlugins get admission plugins off by default for kube-apiserver.
func DefaultOffAdmissionPlugins() sets.String {
  defaultOnPlugins := sets.NewString(
    lifecycle.PluginName,                    // NamespaceLifecycle
    limitranger.PluginName,                  // LimitRanger
    serviceaccount.PluginName,               // ServiceAccount
    setdefault.PluginName,                   // DefaultStorageClass
    resize.PluginName,                       // PersistentVolumeClaimResize
    defaulttolerationseconds.PluginName,     // DefaultTolerationSeconds
    mutatingwebhook.PluginName,              // MutatingAdmissionWebhook
    validatingwebhook.PluginName,            // ValidatingAdmissionWebhook
    resourcequota.PluginName,                // ResourceQuota
    storageobjectinuseprotection.PluginName, // StorageObjectInUseProtection
    podpriority.PluginName,                  // PodPriority
    nodetaint.PluginName,                    // TaintNodesByCondition
    runtimeclass.PluginName,                 // RuntimeClass
    certapproval.PluginName,                 // CertificateApproval
    certsigning.PluginName,                  // CertificateSigning
    certsubjectrestriction.PluginName,       // CertificateSubjectRestriction
    defaultingressclass.PluginName,          // DefaultIngressClass
  )

  return sets.NewString(AllOrderedPlugins...).Difference(defaultOnPlugins)
}
</code></pre><p><a href=https://github.com/kubernetes/kubernetes/blob/ea0764452222146c47ec826977f49d7001b0ea8c/pkg/kubeapiserver/options/plugins.go#L141>Code snippet</a> from Kubernetes Project</p><h4 id=monitoring>Monitoring</h4><p>As several admission controllers are running, the API server provides ways to monitor and troubleshoot admission webhooks, for instance, identify webhooks that reject API requests frequently and the reasons for rejection.</p><h4 id=dynamic-admission-control>Dynamic Admission Control</h4><p>In addition, to the compiled-in admission plugins, custom admission plugins can be implemented as webhooks. Webhooks are either mutating, validating, or both. Mutating webhooks modify the objects in an API request, for instance, injecting sidecars into every pod. Validating webhooks validate objects sent to the API server, for example, limiting all replica sets to a minimum of 3.</p><h5 id=idempotence>Idempotence</h5><p>The API server can call an admission controller multiple times. Idempotence is the property of certain operations in mathematics and computer science whereby they can be applied multiple times without changing the result beyond the initial application. For example, consider that if you are writing an idempotent script to add localhost to /etc/hosts file, you will only append localhost to /etc/hosts file if it does not already exist in the file. Otherwise, if the script added localhost every time it ran, you will have multiple localhost entries.</p><p>An idempotent mutating admission webhook can successfully process an object it has already admitted and potentially modified. For example, let say there are two admission webhooks, AlwaysPulIlmage webhook and insert sidecar webhook. AlwaysPullImage would be called twice, once for the pod object and then after the sidecar injection. As AlwaysPullImage applies to both. On the other hand, you would not want to inject the sidecar every time the API server calls the webhook insert sidecar webhook.</p><h5 id=intercepting-all-versions-of-an-object>Intercepting all versions of an object</h5><p>As Kubernetes supports multiple <a href=https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.21/#-strong-api-groups-strong->API groups/versions</a>, you can set the .webhooks[].matchPolicy to either Exact or Equivalent when defining a webhook. When matchPolicy is Exact, a webhook would only intercept the request when there is an exact match and miss some if a different version modified the same object. It is best to use Equivalent to match all versions of an object; this ensures that admission controllers continue to work even when resources upgrade to newer versions.</p><p>This example shows a validating webhook that intercepts modifications to deployments no matter the API group or version (matchPolicy: Equivalent) and intercepts all apps/v1 Deployment objects:</p><pre><code class=language-yaml>apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingWebhookConfiguration
...
webhooks:
- name: my-webhook.example.com
  matchPolicy: Equivalent
  rules:
  - operations: [&quot;CREATE&quot;,&quot;UPDATE&quot;,&quot;DELETE&quot;]
    apiGroups: [&quot;apps&quot;]
    apiVersions: [&quot;v1&quot;]
    resources: [&quot;deployments&quot;]
    scope: &quot;Namespaced&quot;
...
...
</code></pre><h5 id=availability>Availability</h5><p>Admission webhooks should evaluate objects, usually in a matter of milliseconds, to ensure that they do not increase latency to API requests. Additionally, you should specify a timeout value so that the request fails after the timeout expires if the webhook is not responding. The default timeout value is 10 seconds and must be between 1 to 30 seconds. Also, the webhook design should ensure high availability and performance; for instance, run several webhook backends behind a service in a cluster.</p><h5 id=the-final-state-of-the-object>The final state of the object</h5><p>When implementing a mutating webhook, you can verify the final state of the object by implementing a validating webhook since other webhooks can modify the object after being seen by your mutating webhook.</p><p>Avoiding deadlocks when running webhook backends on the same cluster
Deadlocks can occur if a webhook running inside a cluster starts to intercept and reject its resources. For instance, if the node goes down, the scheduler would assign the pods to another node, and the deployment would go through the admission control again. You can run your webhook backend in a separate namespace and then <a href=https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#matching-requests-namespaceselector>exclude</a> that namespace.</p><h5 id=side-effects>Side-effects</h5><p>When an API server sends an AdmissionReview &ldquo;request&rdquo; to a webhook for review, the webhook responds with an AdmissionReview &ldquo;response.&rdquo;
The webhook should only make changes to the AdmissionReview object passed to them without any out-of-band (<a href=https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#side-effects>side-effects</a>) changes.
If the webhook requires side effects during admission evaluation, it should not make any out-of-band changes if AdmissionReview &ldquo;request&rdquo; specifies that it is a dry run.
The API server does not persist dry-run requests; it processes and evaluates the request and returns the final object to the user. The API server only processes dry-run requests if admission controllers explicitly specify that they do not have any side-effects.</p><pre><code class=language-yaml>{
  &quot;apiVersion&quot;: &quot;admission.k8s.io/v1&quot;,
  &quot;kind&quot;: &quot;AdmissionReview&quot;,
  &quot;request&quot;: {
    # Random uid uniquely identifying this admission call
    &quot;uid&quot;: &quot;705ab4f5-6393-11e8-b7cc-42010a800002&quot;,

...
...
...
    # dryRun indicates the API request is running in dry run mode and will not be persisted.
    # Webhooks with side effects should avoid actuating those side effects when dryRun is true.
    # See http://k8s.io/docs/reference/using-api/api-concepts/#make-a-dry-run-request for more details.
    &quot;dryRun&quot;: false
  }
}
</code></pre><p>AdmissionReview &ldquo;request&rdquo;</p><pre><code class=language-yaml>{
  &quot;apiVersion&quot;: &quot;admission.k8s.io/v1&quot;,
  &quot;kind&quot;: &quot;AdmissionReview&quot;,
  &quot;response&quot;: {
    &quot;uid&quot;: &quot;&lt;value from request.uid&gt;&quot;,
    &quot;allowed&quot;: true
  }
}

</code></pre><p>AdmissionReview &ldquo;response&rdquo;</p><h5 id=do-not-operate-in-the-kube-system-namespace>Do not operate in the kube-system namespace</h5><p>Kubernetes manages its components in the kube-system namespace. Therefore, it would be best if you never ran typical workloads in this namespace. If your webhook mutates or rejects requests in this namespace, it can lead to failure or strange behavior of the control plane. You can exclude namespaces you do intend to operate in by using the <a href=https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#matching-requests-namespaceselector>namespaceSelector</a>.</p><h4 id=key-takeaways>Key takeaways</h4><ul><li>All requests to the API server pass through admission controllers and if successful persisted to the datastore like etcd.</li><li>Admission has two distinct phases. In the first phase, only mutating admission plugins run. Mutating admission plugins may modify the object that they receive. In the second phase, only validating admission plugins run, and they do not modify the objects.</li><li>A plugin can be a validating plugin, mutating plugin, or both.</li><li>The API server calls mutating admission webhooks one by one while it calls validating admission webhooks in parallel.</li><li>Kubernetes enables a recommended set of around 17 admission plugins by default. Admission controllers are part of the API server binary.</li><li>In addition, to the compiled-in admission plugins, custom admission plugins can be implemented as webhooks.</li><li>The API server can call an admission controller multiple times and should be idempotent.</li><li>It is best to set matchPolicy to Equivalent to match all versions of an object; this ensures that admission controllers continue to work even when resources upgrade to newer versions.</li><li>Admission webhooks should evaluate objects, usually in a matter of milliseconds, to ensure that they do not increase latency to API requests.</li><li>You should run your webhook backend in a separate namespace and then exclude that namespace to avoid deadlocks.</li><li>When an API server sends an AdmissionReview &ldquo;request&rdquo; to a webhook for review, the webhook responds with an AdmissionReview &ldquo;response.&rdquo; The webhook should only make changes to the AdmissionReview object passed to them without any out-of-band (side-effects) changes.</li><li>Do not operate in the kube-system namespace.</li></ul></article></div></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a href=https://gohugo.io/>Hugo</a>, and <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=https://foreops.com/contact/>Contact</a></li><li class=list-inline-item><a href=https://foreops.com/contributors/>Contributors</a></li></ul></div></div></div></footer><script src=https://foreops.com/js/highlight.min.382135534ad7d5f348b8dcfbfd466fa7ff0ec4f4c9a43d9a72481c3aff322fe18adeb357aedbd71da568005af873b74f0dbb23cc022f8d04f144991f6f04cb00.js integrity="sha512-OCE1U0rX1fNIuNz7/UZvp/8OxPTJpD2ackgcOv8yL+GK3rNXrtvXHaVoAFr4c7dPDbsjzAIvjQTxRJkfbwTLAA==" crossorigin=anonymous defer></script><script src=https://foreops.com/main.min.cb1cfa565384689404329cbf8ad4a175b59ac6421a528ad947882d8242fc7b62b773cd5967a10349256154f6a67bcdeeb3da0729191ddd4f5623442999e53004.js integrity="sha512-yxz6VlOEaJQEMpy/itShdbWaxkIaUorZR4gtgkL8e2K3c81ZZ6EDSSVhVPame83us9oHKRkd3U9WI0QpmeUwBA==" crossorigin=anonymous defer></script><script src=https://foreops.com/index.min.e02968cfc40d4b5395bf2489e2c574b30d55e9b0bfdb6f8ca7e68d0281e56877eef97cc9fedff0f0c71376068ed68392c88e7dea0f7bfdeda28d3b2613d757bb.js integrity="sha512-4Cloz8QNS1OVvySJ4sV0sw1V6bC/22+Mp+aNAoHlaHfu+XzJ/t/w8McTdgaO1oOSyI596g97/e2ijTsmE9dXuw==" crossorigin=anonymous defer></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-170884460-1','auto'),ga('send','pageview'))</script></body></html>